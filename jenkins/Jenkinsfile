pipeline {
	agent any
    options {
        timeout(time: 1, unit: 'HOURS') 
    }
    stages {
        stage('Clean Workspace') {
            steps {
                // Clean workspace before doing anything
				deleteDir()	
            }
		}
		stage ('Git Clone') {
			steps {
				checkout scm
			}
		}
		stage ('Build') {
			steps {
				bat "echo 'Building...'"
				bat 'mvn clean package'
			}
		}
		stage ('Build Docker Image') {
			steps {
				bat "echo 'Building docker image...'"
				sh "docker build -t tyt/myspringapp:latest ./docker/"
			}		
		}
		stage ('Tests') {
			steps {
				parallel 'static': {
					bat "echo 'shell scripts to run static tests...'"
				},
				'unit': {
					bat "echo 'shell scripts to run unit tests...'"
				},
				'integration': {
					bat "echo 'shell scripts to run integration tests...'"
				}
			}
		}
		stage ('Deploy') {
			steps {
				bat "echo 'shell scripts to deploy to server...'"
			}
		}
    }
}
